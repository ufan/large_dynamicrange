\documentclass[5p, times]{elsarticle}

%%%%%%%%%%%%%%   Preample  %%%%%%%%%%%%%%%%%%

%% The amssymb package provides various useful mathematical symbols
\usepackage{amssymb}
%% The amsthm package provides extended theorem environments
\usepackage{amsthm}
\usepackage{mathtools}

%% for celcius symbol
\usepackage{textcomp}

%% for units
\usepackage{siunitx}

%% The lineno packages adds line numbers. Start line numbering with
%% \begin{linenumbers},  end it with \end{linenumbers}. Or switch it on
%% for the whole article with \linenumbers.
\usepackage{lineno}
\modulolinenumbers[5]

\usepackage{hyperref}

%% package for type Greek letters without entering into math-mode
\usepackage{textgreek}

%% package for large picture in two-colume
\usepackage{dblfloatfix}
\usepackage{fixltx2e}
\usepackage{float}

\usepackage{comment}

%% only jpg pdf eps are allowed, tiff format are not allowed in latex
%% eps in principle can't be compiled by pdflatex, pdf not compiled by latex, but Kile can do some intermedate conversion to allow this happen.
\DeclareGraphicsExtensions{.pdf, .eps, .jpg}
%%opening
\journal{NIMA}

\begin{document}

%%%%%%%%%%%%%% Front Matter %%%%%%%%%%%%%%%%%%
\begin{frontmatter}

\title{Design and verification of a low power large dynamic readout unit for the PSD detector of DAMPE project}

\author[imp,lzu,ucas]{Yong Zhou}

\author[imp]{Yuhong Yu\corref{corresponding_author}}
\cortext[corresponding_author]{Corresponding author}
\ead{yuyuhong@impcas.ac.cn}

\author[imp]{Zhiyu Sun}
\author[imp]{Yongjie Zhang}
\author[imp]{Fang Fang}
\author[imp]{Junling Chen}

\author[lzu]{Bitao Hu}

\address[imp]{Institute of Modern Physics, Chinese Academy of Sciences,  509 Nanchang Road,  Lanzhou,  730000,  P.R.China}
\address[lzu]{School of Nuclear Science and Technology,  Lanzhou University,  222 South Tianshui Road,  Lanzhou,  730000,  P.R.China}
\address[ucas]{Graduate University of the Chinese Academy of Sciences,  19A Yuquan Road,  Beijing,  100049,  P.R.China}

%%
\begin{abstract}

\begin{comment}
A Plastic Scintillator Detector (PSD), consisting of individual 82 organic plastic scintillator strips with 1 cm thick,
located at the top of DAMPE (DArk Matter Particle Explore), has been developed. It mainly serves as anti-coincidence
detector, also as a charge detector to measure cosmic ray nuclei up to charge $Z=20$. A large dynamic range from \SI{0.1}{MIPs} to \SI{1400}{MIPs} has been deduced after consideration various contributions. 
Integrating of a PMT with double dynodes readout and an ASIC chip VA160, a large dynamic readout system has been presented. 
A cosmic ray muons and an accelerator beam test have been used to verify this design, respectively. 
The results show that the readout system could satisfy the required dynamic range. 
\end{comment}

A large dynamic range readout unit is developed for the Plastic Scintillator Detector(PSD) of DArk Matter Paricle Explorer(DAMPE).
By extracting the signal form dynode5 and dynode8 of the photomultiplier tube, the unit can cover the wide signal amplitude range of PSD(from electron to Z=20).
The design has been verified using cosmic ray muon and relativistic Ar beam at CERN.
A dynamic range from \SI{0.1}{MIPs} to \SI{1400}{MIPs} has been achieved.

\end{abstract}

%%
\begin{keyword}
plastic scintillator
\sep VA160
\sep large dynamic range
\sep double dynodes readout

%% PACS codes here,  in the form: \PACS code \sep codes

\end{keyword}

\end{frontmatter}

\linenumbers
%%%%%%%%%%%%%%%%  Introduction  %%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}
\label{sec:introduction}

DArk Matter Paricle Explorer(DAMPE) is a satellite-borne particle detector aiming for in-direct dark matter search, high-energy gamma astronomy and primary cosmic ray study~\cite{Chang_Jin_dampe}.
It is designed to cover a wide energy range, from \SI{5}{GeV} to \SI{10}{TeV} for electrons and photons and from \SI{10}{GeV} to \SI{1}{PeV} for heavy ions, with unprecedented resolution(\SI{1.5}{\percent} at \SI{100}{\giga\electronvolt}).
% By extending the measurement to the \si{TeV} region, DAMPE will complement current experimental results~\cite{guzik_advanced_1999,picozza2010instrument,aguilar2013first} and shed more light on the new phenomena in this region. 
The Plastic Scintillator Detector(PSD), which sits at the top of the satellite, is a key sub-detector of DAMPE.
It consists of two layers of plastic scintillator bars which are orthogonal to each other, and covers an effective detection area of $\SI{820}{mm}\times\SI{820}{mm}$.
The bars are made of EJ-200~\cite{scintillator} with the dimension of $\SI{884}{mm} \times \SI{28}{\milli\meter} \times \SI{10}{mm}$, and coupled to a Hamamatsu R4443 PMT~\cite{r4443} at both ends.
% using \SI{3}{mm}-thick silicon rubber(EJ-560~\cite{scintillator}).

\begin{comment}
To fulfil the requirements and optimize performance, the readout unit of PSD needs a careful design, which is guided by the following rules:
\begin{itemize}
 \item Large dynamic range.To cover the signal amplitude from minimum ionizing electrons to relativistic calcium ions.
 \item Large signla-to-noise ratio(SNR).For efficient charged particle detection.
 \item Low power consumption. The whole PSD is limitted to 19W, 12W for the front end electronics and 7W for the detection units(high voltage distribution and PMT base circuit).
\end{itemize}
\end{comment}
By measuring the deposited energy, PSD serves as an anti-coincidence detector for e/$\gamma$ discrimination as well as a charge detector for heavy ions up to Z=20.
These functions impose harsh demands for the readout system of PSD, which, together with the PMT, needs to cover a wide range of signal amplitudes from singly charged minimum ionizing particles to relativistic calcium ions, while in the same time keeping sufficient resolution and large signal-to-noise ratio(SNR) for effective particle identification.   
As a space experiment, the power consumption of PSD is restricted to be $\leq$19W as a whole, 12W for the front end electronics(FEE) and 7W for the high voltage distribution and PMT base circuit.
This adds an extra constraint in the design of the readout unit.

In this paper, a low power and large dynamic range readout unit for PSD is reported.
Verification tests for the design have been carried out using cosmic ray and relativistic heavy ion beam, and the results are satisfactory.
The detailed description of the design is presented in Sec.\ref{sec:requirement} and Sec.\ref{sec:design}, and the test results are discussed in Sec.\ref{sec:result}.

%%%%%%%%%%%%%%%% Main Text Body %%%%%%%%%%%%%%%%%%%%%%%
\section{Dynamic range requirement}
\label{sec:requirement}

\begin{figure*}
\centering
 \includegraphics[width=140mm]{readout_scheme}
\caption{Readout scheme of PSD.}
\label{fig:readout_scheme}
\end{figure*} 

\begin{figure*}
\centering
 \includegraphics[width=130mm]{divider}
\caption{Circuit diagram of the voltage divider.}
\label{fig:divider}
\end{figure*} 

\subsection{Light yield in response to relativistic heavy ions}
% According to the Bethe-Bloch equation~\cite{olive_review_2014}, the energy deposited in PSD bars is approximately proportional to $Z^2$ for particles heavier than electron.
The light yield of organic scintillators is a nonlinear function of the desposited energy $\Delta E$ due to the quenching effect.
It can be described precisely by the Birks law~\cite{birks_theory_2013} in the low energy range, while for heavy ions in the relativistic region, the scintillation mechanism gets much more complicated and the Birks law fails to apply.
Several modified models~\cite{chou_nature_1952,tarle_cosmic_1979,menchaca-rocha_response_1999,matsufuji_response_1999} have been proposed to extend the Birks law to the high energy region, nevertheless large discrepancy exists between them when extrapolating to the high-Z nuclides.

Due to the theoretical difficulties metioned above, our estimation of the light yield is based on the direct beam test result of AMS-02 TOF prototype~\cite{marrocchesi2011beam}, which also uses EJ-200 as the detection material and has the same thickness.
According to ~\cite{marrocchesi2011beam}, the light output of calcium is about 270 times larger than that of proton.
As all singly charged minimum ionization particles have approximately the same response in the plastic scintillator, this result indicates a maximum of 270 times difference in the light yield for all the particle species covered by PSD.

\subsection{Miscellaneous contributions to the dynamic range}

Actual dynamic range needed by PSD is expanded by several other contributions. 
To make things clear, we define the mean light yield produced by a singly charged minimum ionizing particle penetrating through vertically in the middle of the bar as one MIP, and use it as the unit for the dynamic range calculation.

The first contribution comes from DAMPE's broad field of view, which implies a maximum incidence angle of \SI{60}{\degree} for particles through PSD.
This doubles the travel length and the energy deposit in the bar, and expands the maximum light yield to \SI{540}{MIPs}.  
Secondly, the statistical nature of the ionizing process should be taken into account.
Assuming a full coverage of the energy fluctuation is 5$\sigma$ and $\sigma$=\SI{10}{\percent}, the dynamic range of light output expands to \SI{675}{MIPs} in the upper limit and \SI{0.75}{MIPs} in the lower limit. 
Finally, the long length of the scintillator bar makes the light attenuation non-negligible.
The bars are surface-polished and wrapped by the Tyvek paper~\cite{tyvek} to improve reflection efficiency, and preliminary tests show that the light reduction ratio between the middle position and the two ends can be well controlled above 0.5.
Thus, the light collected by the end PMTs will vary between \SI{0.375}{MIPs} and \SI{1350}{MIPs}.

To leave some redundancy for the adjustment, the final dynamic range required by the readout unit of PSD is determined to be \SI{0.1}{MIPs}$\sim$\SI{1400}{MIPs}.

\section{Design of the readout unit}
\label{sec:design}
% Power consumption and robustness are the major concern in the design of a readout unit for space usage.
\begin{figure*}[b]
 \centering
 \includegraphics[width=130mm]{cosmic_test}
\caption{The experimental setup for the cosmic ray test.}
\label{fig:cosmic_test}
\end{figure*} 

\subsection{Readout scheme}
The ASIC chip VA160, which is developed by IDEAS~\cite{va160} and optimized for the DAMPE project, is adopted as the major signal processing circuit for the charge measurement of PSD.
% due to its low power consumption, high channel integration and successful applications in space usage~\cite{alcaraz_alpha_}.
VA160 is a low power and radiation harden ASIC with a dynamic range from \SI{-5}{\pico\coulomb} to \SI{13}{\pico\coulomb}. 
It integrates 32 input channels into a single chip, and each channel consists of a full chain of charge sensitive pre-amplifier, shaping amplifier and sample-and-hold circuit.
% The high integration level allows compact design of .
% Thus, current pulses from R4443 can be connected to VA160 directly, and the output will be digitized by a 14 bits ADC.

A single VA160 channel is not sufficient to cover the full dynamic range required by PSD.
We adopt the readout scheme of extracting signals from two dynodes of R4443 and then connecting them to separate VA160 channels.
Two measurement ranges can be achieved in this way, with the high gain dynode channel for small light output measurement and the low gain dynode channel for large light output measurement.
While alternative methods exist~\cite{katayose2008development,kampert1994high,genolini_low_2003}, this readout scheme is preferred because the largest SNR can be achieved without adding extra active electronic components, which in turn implies low power consumption and robustness.
To reduce the crosstalk effect, signals from the two dynodes are connected to different VA160 chips as shown in Fig.\ref{fig:readout_scheme}.

FEE board based on VA160 has been developed and fully tested~\cite{fee}. Outputs from VA160 are digitized by a 14 bits ADC.
A linear range up to \SI{12}{\pico\coulomb} is guaranteed for each FEE channel, and the mean RMS electronic noise is about \SI{4}{\femto\coulomb} when connected to the PSD detector module. 
The electronic noise level determines the lower limit of the dynamic range.
Assuming the maximum noise level is \SI{50}{\percent} larger than the typical value and 5$\sigma$ is needed to separate signal from noise, this implies the response of \SI{0.1}{MIPs} shall be larger than \SI{30}{\femto\coulomb}, i.e. 1MIPs$\geq$\SI{300}{\femto\coulomb}.
Hence the maximum dynamic range covered by the high gain dynode channel is \SI{0.1}{MIPs}$\sim$\SI{40}{MIPs}, and the remaining range shall be covered by the low gain dynode channel.
This constrains the gain ratio between the two dynodes to be $\geq$35.

\subsection{Selection of the dynode stages}
To determine the appropriate dynode stages for readout, an estimation of the mean number of photon electrons(PE) generated by one MIP in the middle of the bar is carried out.

The mean energy deposit of the MIP particle in a \SI{10}{\milli\meter} plastic scintillator is about \SI{2.0}{\mega\electronvolt}~\cite{olive_review_2014}, and the scintillation efficiency of EJ-200 is \SI[per-mode=symbol]{e4}{photons\per\mega\electronvolt}~\cite{scintillator}.
Light output is distributed to both ends of the bar equally.
However, only \SI{22.5}{\percent} of the generated photons are within the total reflection angle and will undergo the transmission process to the end of the bar, due to the refraction on the boundary.
The final number of photon electrons is calculated as follows:
\begin{align}
 N_{PEs} &= \frac{1}{2} \times \SI[per-mode=symbol]{2}{\mega\electronvolt} \times \SI{e4}{\per\mega\electronvolt} \times 0.225
           \times \varepsilon_{1} \times \varepsilon_{2} \times \varepsilon_{3} \times \varepsilon_{4} \nonumber \\
         &\approx \SI{45}{e^-\per{MIP}}
\label{eq:pes}
\end{align} 
where $\varepsilon_1$($\geq$0.5) is the light attenuation ratio caused by the transmission loss from the middle position to the end of the bar,
$\varepsilon_2$($\approx$0.3) is the the geometry factor induced by the effective coupling area between R4443 input window and the bar's end surface,
$\varepsilon_3$($\approx$0.9) is the transmission coefficient of the silicon rubber which is the coupling material between R4443 and the bar,
and $\varepsilon_4$($\approx$0.15) is the quantum efficiency of R4443 cathode.
The value of $\varepsilon_1$ is based on the measurement results~\cite{zhangyj_scintillator}, $\varepsilon_2$ is the calculation result of the effective coupling area divided by the end surface area, $\varepsilon_3$ and $\varepsilon_4$ are from the datasheets.

R4443 is a 10-stage PMT with a gain of $1\times10^6$ at the typical supply voltage using standard voltage divider(i.e. equal voltage drop between dynodes).
A simple calculation shows that the multiplication factor between adjacent dynodes is about 4.
Combining this result with the estimated PE numbers from Eq.~\ref{eq:pes}, dynode 5 and 8 are selected as the readout composition, which corresponds to a MIP response of \SI{450}{\femto\coulomb} and a gain ratio of 65.
The figures are both higher than the desired value, thus the supply voltage need to be lowered to get the optimal result.
The composition of dynode 5 and 7 with higher voltage supply is an alternative choice, it is dismissed because this increases power consumption, reduces the adjustment flexibility and may even exceed the allowed PMT operation voltage in the worst case.

\subsection{Voltage divider circuit}
A cathode grouding voltage divider circuit, which can extract current pulses from both dynode 5 and 8, is designed as shown in Fig.\ref{fig:divider}.
The uniform voltage distribution ratio is adopted instead of the ``tapered'' one, because R4443 is a small size tube and the space charge effect at dynode 8 is not an issue at the PSD light intensity level.
To retain the voltage ratio between the latter dynodes and in turn improve linearity, the parallel decoupling capacitors C1$\sim$C7 are added to compensate the charge required in the formation of large signals.

As positive high voltage is supplied, coupling capacitors are needed in the dynode readout branch circuits.
Two serial-chained capacitors(C8/C9 and C11/C12) are used in each branch to provide robustness, in case that one of them breaks down and the other can still protect the following circuits.  
The ramping resistors R10/R11 and bypass capacitors C10/C13 are added to better form the output pulse shape.
Finally, signals from dynode 5 and 8 are connected to the FEE board using coaxial cables to reduce crosstalk effect between them.

\section{Tests result}
\label{sec:result}

\subsection{Test with LED}

\subsection{Test with cosmic ray}
\label{sec:cosmicray}

Cosmic ray muons are the most numerous energetic charged at sea level with a mean energy of about 4 GeV, and are typically MIPs. 
As muons penetrating orthogonally in 1 cm scintillator, the amount of energy around 1 MIPs leaves on average per unit length. 
So a cosmic ray muons test was used to study the MIPs response at the laboratory. 
The layout of the test setup for a scintillator strip with cosmic ray muons is shown in Fig.~\ref{fig:cosmic_test}. 
Two small trigger, with the dimension of \ 1.0×1.0×1.0 cm\textsuperscript{3}, also made with scintillator are fixed on a movable support to investigate the performance of the readout system, and point-by-point measurement has been carried out. 

Fig.~\ref{fig:mip} shows a typical MIPs energy spectrum read out from Dy8. 
The amplitude spectrum has an asymmetric form with a longer right-hand tail which is characteristic for thin absorbers. 
The most probable amplitude of the distribution characterizing mean energy losses for MIPs is obtained by fitting a Landau function to the spectrum as shown in Fig.~\ref{fig:mip}. 
The most probable value of MIPs signals is 396.5 ADC counts. 
It’s approximately \SI{320}{\femto\coulomb} when the ADC count is converted into charge. 
The amplitude distribution of the pedestal for each signal channel is also shown in Fig.~\ref{fig:mip}.
From the Figure, we can find that the input noise of the whole PSD system is approximate 3 fC, which is merely half of the expected value. 
As a result of 0.1 MIPs signals, the most probable value of the signal-to-noise of the PSD system is greater than 10, and this value is exceeding the expected requirement for a 5$\sigma $ separation from the whole PSD detector pedestal.

\begin{figure}
 \centering
 \includegraphics[width=90mm]{mip}
\caption{The pulse height distribution of cosmic muons from a low gain channel Dy8.}
\label{fig:mip}
\end{figure} 

The light attenuation of the scintillator strip could not be negligible for the required dynamic range. 
Fig.~\ref{fig:attenuation} shows the charge amplitude at various locations along the scintillator strip, and it’s found that the amplitude is well fitted by an exponent fit. 
In the figure, the charge amplitude at different hit locations is scaled to the middle hit position. 
It’s shown that the amplitude of charge pulse is not independent on the hit position. 
From the fitting data, the ratio between the nearest and the farthest hit position from the same readout PMT is not greater than 4, so it is not beyond the former desired value.

\begin{figure}
 \centering
 \includegraphics[width=90mm]{attenuation}
\caption{The charge pulse amplitude at different hit positions along the tested scintillator strip.}
\label{fig:attenuation}
\end{figure} 

The charge ratio of a low gain channel Dy8 and a high gain channel Dy5 is shown in Fig.~\ref{fig:dy58}. 
From figure, the charge collection of the Dy8 reach the maximum dynamic range of the VA160, and the saturation level is found to be about \SI{12}{\pico\coulomb}. 
From a linearity fit, the relative gain for Dy8/Dy5 of 44.6 could be derived, so the upper dynamic range of about 1670 MIPs can be obtained from a calculation using Eq.~\ref{eq:range}.
\begin{equation}
 Range_{upper} = k_{e}(Dy8/Dy5)
 \label{eq:range}
\end{equation} 
where $k_e$ is the VA160 charge dynamic range, and the adopted upper range of VA160 is \SI{12}{\pico\coulomb}.
Apparently, the required upper dynamic range1400 MIPs could be covered by our design.

\begin{figure}
 \centering
 \includegraphics[width=90mm]{dy58}
\caption{The correlation between the signals in a low gain channel Dy8 and a high gain Dy5.}
\label{fig:dy58}
\end{figure} 

\subsection{Test with relativistic heavy ion beam}
\label{sec:beam}

A scintillator strip of PSD were tested at CERN SPS ion beam facility to verify our design to the required upper dynamic range. 
A primary of $^{40}Ar$($Z=18$) was accelerated to \SI{40}{AGeV\per c}, and the charge of Argon crossing the scintillator strip was measured by looking at its energy loss. 
The most probable value and the sigma of energy deposition from a relativistic Argon beam are about 217 MIPs and 4.2\% in the Fig.~\ref{fig:Ar}, respectively. 
A linear extrapolation is used to obtain the energy deposition for the Calcium ($Z=20$), and the most probable energy deposition for PSD scintillator strip is 268 MIPs from a calculation. 
Since the quenching effect existing, the actual energy deposition is a little smaller than 268 MIPs, and this value is not out of our former estimation. 
Assumption the sigma of energy deposition is 5\%, the upper limit of the amplitude of the charge pulse is 1340 MIPs as the incident Calcium particles cross the scintillator strip with the largest field view of DAMPE and a $5\sigma$ energy fluctuation is considered for the nearer readout PMT. 
This value is within the limits of our design.

\begin{figure}
 \centering
 \includegraphics[width=90mm]{Ar}
\caption{The energy deposition distribution from a relativistic $^{40}Ar$ beam.}
\label{fig:Ar}
\end{figure} 

\section{Conclusion}
\label{sec:conclustion}

A broad energy dynamic range of 0.1 MIPs$\sim$1400 MIPs required for each PSD has been deduced from a number of contributions, including energy deposition of nuclei up to charge $Z=20$, light attenuation, particle incidence angle and fluctuation of energy loss. 
A readout system that used a PMT with double dynodes output coupled to FEE with a chip VA160 optimized for positive polarity signals has been developed and used to measure the energy deposition in a scintillator strip. 
Cosmic ray muons were used to investigate the influence of scintillation light attenuation, MIPs peak and the equivalent noise of the whole detector system. 
The input noise of the whole PSD system is approximately \SI{3}{\femto\coulomb}, and the most probable value of the signal-to-noise is greater than 10 for the lower signals with 0.1 MIPs energy deposition. 
It’s also found that the required upper dynamic range 1400 MIPs could be covered by our design easily. 
A relativistic argon beam test has been also used to verify the design. 
Once again the result shows that the readout system could satisfy the large dynamic range requirements.

\subsection{summary}
power consumption
dynamic range

\subsection{production suggestions}
test of pmt
selection of scintillator bar

%%%%%%%%%%%%%%%% Acknowledgement %%%%%%%%%%%%%%%%%%%%%%%
\section*{Acknowledgement}
\label{sec:acknowledgement}

This work was supported by the Strategic Priority Research Program on Space Science of the Chinese Academy of Science,
Grant No. XDA04040202- 3. The authors wish to thank all the people from DAMPE collaboration who helped make this work
possible.

%%%%%%%%%%%%%%%%   Bibliography  %%%%%%%%%%%%%%%%%%%%%%%
%% bibliography style
\section*{References}
\label{sec:reference}
\bibliographystyle{elsarticle-num}

%% From BibTex file
\bibliography{mybib}

\end{document}

\endinput




